(()=>{"use strict";function e(e){var t=document.createElement("textarea");return t.placeholder=e,t.className="custom-textarea",t.style.display="block",t.style.width="100%",t.style.boxSizing="border-box",t}function t(e,t,n){var o=document.createElement("div");o.style.marginRight="10px",o.classList.add("custom-radio-container");var a=document.createElement("input");a.type="radio",a.name=t,a.checked=n,a.style.marginRight="5px";var i=document.createElement("label");return i.textContent=e,o.appendChild(a),o.appendChild(i),{container:o,input:a}}function n(e){var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=e.textArea.trigger,o=e.textArea.action,a=e.textArea.cause;t?(n.classList.add("dark-mode"),o.classList.add("dark-mode"),a.classList.add("dark-mode")):(n.classList.add("light-mode"),o.classList.add("light-mode"),a.classList.add("light-mode"))}function o(e,t){t.noteTypeRadio.resultOption.input.checked?(r(t,!1),d(t,!0)):(r(t,!0),d(t,!1))}function a(e,t){e.disabled=!t}function i(e){a(e.button.addResult,""!=e.textArea.trigger.value&&""!=e.textArea.action.value&&""!=e.textArea.cause.value)}function r(e,t){t?(e.opsgenie.noteInput.style.display="block",e.opsgenie.addNoteButton.style.display="block"):(e.opsgenie.noteInput.style.display="none",e.opsgenie.addNoteButton.style.display="none")}function d(e,t){t?(e.textArea.trigger.style.display="block",e.textArea.action.style.display="block",e.textArea.cause.style.display="block",e.button.addResult.style.display="block"):(e.textArea.trigger.style.display="none",e.textArea.action.style.display="none",e.textArea.cause.style.display="none",e.button.addResult.style.display="none")}var s={id:null,startedAt:null};function l(e,t){t.parentElement.insertBefore(e,t)}function c(r){console.log("Modifying note sidebar");var d=function(n){document.querySelectorAll(".custom-textarea, .custom-radio-container").forEach((function(e){return e.remove()}));var o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.classList.add("custom-radio-container");var a=t("Result","mode",!0),i=t("Note","mode",!1);o.appendChild(a.container),o.appendChild(i.container);var r,d,s=(r=o,(d=document.createElement("div")).className="tooltip",d.innerHTML="<b>Select the Note Type:</b></br></br>\n        - <b>Result:</b> To add findings and conclusions after analysis</br>\n        - <b>Note:</b> To log changes and events during a war room session or troubleshooting",d.style.display="block",r.addEventListener("mouseover",(function(){d.classList.add("show")})),r.addEventListener("mouseout",(function(){d.classList.remove("show")})),d),l=e("Trigger: What triggered the alert?"),c=e("Action: What did you had to do?"),u=e("Cause: What was the root cause?"),p=document.querySelector(".primary-grey.compact-button"),g=p.cloneNode(!0);return Array.from(g.attributes).forEach((function(e){"class"!=e.name&&"style"!=e.name&&g.removeAttribute(e.name)})),g.style.position="relative",g.querySelector("b").textContent="Add Result",{opsgenie:{noteInput:n,addNoteButton:p},noteTypeRadio:{container:o,noteOption:i,resultOption:a},textArea:{trigger:l,action:c,cause:u},button:{addResult:g},tooltip:{radioContainer:s}}}(r);!function(e){var t,n;l(e.noteTypeRadio.container,e.opsgenie.noteInput),l(e.tooltip.radioContainer,e.noteTypeRadio.container),l(e.textArea.trigger,e.opsgenie.noteInput),l(e.textArea.action,e.opsgenie.noteInput),l(e.textArea.cause,e.opsgenie.noteInput),t=e.button.addResult,(n=e.opsgenie.addNoteButton).parentNode.insertBefore(t,n.nextSibling)}(d),function(e){e.noteTypeRadio.resultOption.input.addEventListener("change",(function(t){return o(0,e)})),e.noteTypeRadio.noteOption.input.addEventListener("change",(function(t){return o(0,e)})),e.button.addResult.addEventListener("click",(function(t){if(console.log("Add note button clicked"),e.noteTypeRadio.resultOption.input.checked){var n={trigger:e.textArea.trigger.value,action:e.textArea.action.value,cause:e.textArea.cause.value},o="\n            Trigger: ".concat(e.textArea.trigger.value,"\n\n            Action: ").concat(e.textArea.action.value,"\n\n            Cause: ").concat(e.textArea.cause.value,"\n\n            ========JSON========\n\n            ").concat(JSON.stringify(n),"\n            ======JSON=END======\n\n            ");e.opsgenie.noteInput.value=o,console.log("Note input value set to:",e.opsgenie.noteInput.value);var a=new Event("input",{bubbles:!0});e.opsgenie.noteInput.dispatchEvent(a),s.id||(s.startedAt=new Date,s.id=setInterval((function(){var t=e.opsgenie.noteInput;if(s.id)return""===t.value?(clearInterval(s.id),s.id=null,s.startedAt=null,console.log("Input note has changed been cleared"),e.textArea.trigger.value="",e.textArea.action.value="",void(e.textArea.cause.value="")):void(new Date-s.startedAt>1e4&&(console.log("Input note has changed been cleared due to timeout"),clearInterval(s.id),s.id=null,s.startedAt=null))}),100));var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});e.opsgenie.addNoteButton.dispatchEvent(i)}}),!0),e.opsgenie.noteInput.addEventListener("input",(function(t){t.currentTarget.value,a(e.opsgenie.addNoteButton,t.currentTarget.value)}),!0),e.textArea.trigger.addEventListener("input",(function(t){i(e)}),!1),e.textArea.action.addEventListener("input",(function(t){i(e)}),!1),e.textArea.cause.addEventListener("input",(function(t){i(e)}),!1),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",n)}(d),document.querySelector(".side-contents.add-note-always").style.padding=0,document.querySelector(".side-header.has-action").style.height="fit-content",document.querySelector(".side-header.has-action").style.position="relative",document.querySelector(".send-note.ops-form").style.height="fit-content",document.querySelector(".area-description .genie-checkbox").style.display="none",document.querySelector(".area-description .info").style.display="none",document.querySelector(".area-description .primary-grey.compact-button").style.position="relative",n(d),o(0,d),a(d.opsgenie.addNoteButton,!1),i(d)}function u(){return/^https:\/\/.*\.opsgenie\.com\/alert\/detail\/.*/.test(window.location.href)}var p=window.location.href;function g(){console.log("DOM fully loaded and parsed");var e=setInterval((function(){var t=document.querySelector(".ops-textarea");t?(console.log("Note input field found:",t),clearInterval(e),u()&&(c(t),new MutationObserver((function(){p!==window.location.href&&(p=window.location.href,console.log("URL changed:",p),u()&&document.querySelector(".ops-textarea")&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",g):g()))})).observe(document.body,{childList:!0,subtree:!0}))):console.log("Note input field not found, retrying...")}),1e3)}chrome.storage.local.get(["enhancedOpsgenieAlertNotesPluginEnalbed"],(function(e){!1!==e.enhancedOpsgenieAlertNotesPluginEnalbed?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",g):g():console.log("Plugin is disabled")}))})();
//# sourceMappingURL=plugin.unified-script.js.map